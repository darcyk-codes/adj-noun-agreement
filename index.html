<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Prompt Builder</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#111827" />
  <style>
    :root{
      --bg:#0f172a;          /* slate-900 */
      --panel:#111827;       /* gray-900 */
      --subtle:#1f2937;      /* gray-800 */
      --muted:#9ca3af;       /* gray-400 */
      --text:#e5e7eb;        /* gray-200 */
      --accent:#60a5fa;      /* blue-400 */
      --accent-strong:#3b82f6; /* blue-500 */
      --ring: rgba(96,165,250,.45);
      --radius: 16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",sans-serif;
      background:linear-gradient(180deg,var(--bg),#0b1023);
      color:var(--text);
    }
    .wrap{max-width:1100px;margin:0 auto;padding:24px}

    .topbar{display:flex;align-items:center;gap:16px;justify-content:space-between;margin-bottom:20px}
    .title{font-weight:700;font-size:20px;letter-spacing:.2px}

    .btn{border:1px solid var(--subtle);background:var(--panel);color:var(--text);padding:10px 14px;border-radius:12px;cursor:pointer;transition:.18s ease;line-height:1;display:inline-flex;gap:8px;align-items:center}
    .btn:hover{border-color:var(--accent);box-shadow:0 0 0 3px var(--ring)}
    .btn.primary{background:var(--accent-strong);border-color:transparent}
    .btn.lg{font-size:16px;padding:12px 18px}

    .grid{display:grid;grid-template-columns:1fr;gap:28px}
    @media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}

    .card{border:1px solid var(--subtle);background:linear-gradient(180deg,rgba(31,41,55,.65),rgba(31,41,55,.3));border-radius:var(--radius);padding:12px 16px 18px}
    .card h2{margin:0 0 10px;font-size:16px;font-weight:700;color:#cbd5e1}

    .reel{display:flex;gap:8px;overflow-x:auto;scrollbar-width:thin;scrollbar-color:var(--muted) transparent;padding:8px;border:1px dashed var(--subtle);border-radius:12px;min-height:64px;align-items:center;background:rgba(17,24,39,.4)}
    .chip{padding:8px 10px;border-radius:999px;background:#0b1228;border:1px solid #1b2747;color:#dbeafe;white-space:nowrap;font-size:14px}

    /* Controls BELOW the reels (restored) */
    .controls-row{display:flex;flex-wrap:wrap;gap:16px;align-items:center;margin-top:24px}
    .control-group{display:flex;align-items:center;gap:8px;padding:8px 10px;border:1px solid var(--subtle);border-radius:999px;background:rgba(17,24,39,.6)}
    .control-label{font-size:12px;color:#cbd5e1}
    .segmented{display:inline-grid;grid-auto-flow:column;border:1px solid var(--subtle);border-radius:999px;overflow:hidden;background:rgba(17,24,39,.85)}
    .segmented input{position:absolute;opacity:0;pointer-events:none}
    .segmented label{padding:6px 10px;font-size:12px;cursor:pointer;user-select:none;line-height:1;white-space:nowrap;color:#cbd5e1}
    .segmented label:hover{background:rgba(59,130,246,.12)}
    .segmented input:checked + label{background:var(--accent-strong);color:white}

    .prompt{margin-top:18px;border:1px solid var(--subtle);border-radius:12px;padding:12px;background:rgba(17,24,39,.45)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="title">Prompt Builder</div>
      <div class="actions" style="display:flex;gap:10px">
        <button id="btnNew" class="btn lg">New Prompt</button>
        <button id="btnCheck" class="btn lg">Check</button>
      </div>
    </div>

    <div class="grid">
      <!-- Adjectives column -->
      <section id="adjectivesSection" class="card">
        <h2>Adjectives</h2>
        <div class="reel" id="adjectivesReel" aria-live="polite"></div>
      </section>

      <!-- Nouns column -->
      <section id="nounsSection" class="card">
        <h2>Nouns</h2>
        <div class="reel" id="nounsReel" aria-live="polite"></div>
      </section>
    </div>

    <!-- RESTORED: Sort toggles and Hints below the reels -->
    <div class="controls-row" id="controlsRow">
      <div class="control-group" aria-label="Adjectives sort options">
        <span class="control-label">Adjectives</span>
        <div class="segmented" role="tablist" aria-label="Adjectives sort mode">
          <input type="radio" id="adj-sort-alpha" name="adjSort" value="alpha" checked>
          <label for="adj-sort-alpha" role="tab" aria-selected="true">A–Z</label>
          <input type="radio" id="adj-sort-random" name="adjSort" value="random">
          <label for="adj-sort-random" role="tab">Random</label>
        </div>
      </div>

      <div class="control-group" aria-label="Nouns sort options">
        <span class="control-label">Nouns</span>
        <div class="segmented" role="tablist" aria-label="Nouns sort mode">
          <input type="radio" id="noun-sort-alpha" name="nounSort" value="alpha" checked>
          <label for="noun-sort-alpha" role="tab" aria-selected="true">A–Z</label>
          <input type="radio" id="noun-sort-random" name="nounSort" value="random">
          <label for="noun-sort-random" role="tab">Random</label>
        </div>
      </div>

      <button id="btnHints" class="btn" aria-pressed="false">Hints: Off</button>
    </div>

    <div class="prompt" id="promptOutput" aria-live="polite"></div>
  </div>

  <script>
    // --- Demo data & state (replace with your existing data plumbing) ---
    const adjectives = ["brave","clever","daring","elegant","fancy","gentle","happy","icy","jolly","kind","lively"]; 
    const nouns      = ["astronaut","bridge","compass","dragon","engine","forest","galaxy","harbor","island","jewel","kite"];

    let adjSortMode = localStorage.getItem('adjSort') || 'alpha';
    let nounSortMode = localStorage.getItem('nounSort') || 'alpha';

    const $ = sel => document.querySelector(sel);

    const adjReel  = $('#adjectivesReel');
    const nounReel = $('#nounsReel');

    function renderReel(list, el){
      el.innerHTML = '';
      list.forEach(w => {
        const chip = document.createElement('div');
        chip.className = 'chip';
        chip.textContent = w;
        el.appendChild(chip);
      });
    }

    function shuffle(arr){
      const a = arr.slice();
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]] = [a[j],a[i]];
      }
      return a;
    }

    function applySortAndRender(){
      const adj = (adjSortMode === 'alpha') ? adjectives.slice().sort((a,b)=>a.localeCompare(b)) : shuffle(adjectives);
      const nn  = (nounSortMode === 'alpha') ? nouns.slice().sort((a,b)=>a.localeCompare(b)) : shuffle(nouns);
      renderReel(adj, adjReel);
      renderReel(nn,  nounReel);
    }

    // Initialize radio states from storage
    function syncRadios(){
      const aAlpha = $('#adj-sort-alpha'), aRand = $('#adj-sort-random');
      const nAlpha = $('#noun-sort-alpha'), nRand = $('#noun-sort-random');
      aAlpha.checked = (adjSortMode==='alpha');
      aRand.checked  = (adjSortMode==='random');
      nAlpha.checked = (nounSortMode==='alpha');
      nRand.checked  = (nounSortMode==='random');
    }

    document.addEventListener('change', (e)=>{
      if(e.target.name === 'adjSort'){
        adjSortMode = e.target.value; localStorage.setItem('adjSort', adjSortMode); applySortAndRender();
      }
      if(e.target.name === 'nounSort'){
        nounSortMode = e.target.value; localStorage.setItem('nounSort', nounSortMode); applySortAndRender();
      }
    });

    // Hints toggle
    const btnHints = $('#btnHints');
    btnHints.addEventListener('click', ()=>{
      const on = btnHints.getAttribute('aria-pressed') === 'true';
      btnHints.setAttribute('aria-pressed', String(!on));
      btnHints.textContent = `Hints: ${!on ? 'On' : 'Off'}`;
      // Hook into your hints logic here
    });

    // Top-right buttons
    $('#btnNew').addEventListener('click', ()=>{
      $('#promptOutput').textContent = '✨ New prompt generated.';
    });
    $('#btnCheck').addEventListener('click', ()=>{
      $('#promptOutput').textContent = '✅ Prompt looks good!';
    });

    syncRadios();
    applySortAndRender();

    if ('serviceWorker' in navigator){
      window.addEventListener('load', ()=>{
        navigator.serviceWorker.register('/service-worker.js');
      });
    }
  </script>
</body>
</html>
